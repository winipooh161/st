# Документация по улучшенному компоненту выбора даты

## Общая информация

Улучшенный компонент выбора даты для шаблонов предоставляет удобный интерфейс для редактирования дат в шаблонах документов. Компонент включает в себя встроенный календарь, который появляется под выбранным элементом и позволяет легко выбирать даты.

## Особенности компонента

- Удобный выбор дат с помощью календаря
- Поддержка различных форматов дат
- Русская локализация
- Автоматическое закрытие календаря при выборе даты или клике вне календаря
- Отсутствие мобильных input-полей, которые могут вызывать конфликты
- Адаптивный дизайн
- Плавные анимации открытия/закрытия

## Использование в шаблонах

Для использования компонента выбора даты в шаблоне, необходимо добавить элемент с соответствующими атрибутами:

```html
<span 
  data-editable="field_id" 
  data-field-name="Название поля" 
  data-field-type="date" 
  data-date-format="dd.mm.yyyy" 
  class="template-editable template-date-field">01.01.2025</span>
```

### Атрибуты

- `data-editable` - ID поля для сохранения значения
- `data-field-name` - Человекочитаемое название поля
- `data-field-type="date"` - Обязательный атрибут, указывающий на тип поля "дата"
- `data-date-format` - Формат даты (необязательно, по умолчанию "dd.mm.yyyy")

## Инициализация

Компонент инициализируется автоматически при загрузке скрипта `template-editor-improved.js`. Для этого необходимо, чтобы в шаблоне был подключен компонент скриптов:

```blade
@include('templates.components.template-scripts')
```

## Стили

Стили для компонента находятся в файле `css/templates/date-picker-enhanced.css`. Они автоматически подключаются вместе с компонентом скриптов.

## Обработка значений

После выбора даты, значение автоматически обновляется в объекте `window.templateData.editableFields` и может быть сохранено на сервере с помощью метода `TemplateEditor.saveTemplateData()`.

## Форматы даты

Поддерживаются различные форматы даты, которые можно указать в атрибуте `data-date-format`:

- `dd.mm.yyyy` - 31.12.2025
- `yyyy-mm-dd` - 2025-12-31
- `mm/dd/yyyy` - 12/31/2025
- `d MMMM yyyy` - 31 декабря 2025

## Пример полного блока с датой начала и окончания

```html
<div class="date-range">
    <div>
        <strong>Дата начала:</strong> 
        <span data-editable="start_date" data-field-name="Дата начала" data-field-type="date" data-date-format="dd.mm.yyyy" class="template-editable template-date-field">04.07.2025</span>
    </div>
    <div>
        <strong>Дата окончания:</strong> 
        <span data-editable="end_date" data-field-name="Дата окончания" data-field-type="date" data-date-format="dd.mm.yyyy" class="template-editable template-date-field">31.12.2025</span>
    </div>
</div>
```

## Устранение проблем

При возникновении проблем с выбором даты, проверьте:

1. Правильно ли подключены все необходимые стили и скрипты
2. Правильно ли указаны атрибуты для элементов с датами
3. Отображается ли библиотека flatpickr в консоли разработчика
4. Нет ли ошибок в консоли разработчика

В случае возникновения ошибок, обратитесь к документации библиотеки flatpickr: https://flatpickr.js.org/

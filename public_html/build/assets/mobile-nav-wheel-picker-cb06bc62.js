import{M as o,a as i,b as t,c as l,d as s,e as n}from"./MobileNavUtils-5a4f7da0.js";class r{constructor(){console.log("🎡 MobileNavWheelPicker: Начало инициализации");try{this.core=new o,console.log("✅ MobileNavCore инициализировано"),this.storage=new i,console.log("✅ MobileNavStorage инициализировано"),this.scroll=new t(this.core),console.log("✅ MobileNavScroll инициализировано"),this.popup=new l(this.core),console.log("✅ MobileNavPopup инициализировано"),this.utils=new s(this.core,this.scroll),console.log("✅ MobileNavUtils инициализировано"),this.events=new n(this.core,this.scroll,this.popup),console.log("✅ MobileNavEvents инициализировано")}catch(e){console.error("⛔ Ошибка при инициализации компонентов навигации:",e)}window.MobileNavWheelPicker=this,setTimeout(()=>{try{this.initScrollTracking(),console.log("✅ Отслеживание скролла инициализировано")}catch(e){console.warn("⚠️ Ошибка инициализации отслеживания скролла:",e)}},300),setTimeout(()=>{try{this.initModalIntegration(),console.log("✅ Интеграция с модальной системой инициализирована")}catch(e){console.warn("⚠️ Ошибка интеграции с модальной системой:",e)}},500),this.setupPublicAPI(),console.log("🎡 MobileNavWheelPicker: Инициализация завершена")}initModalIntegration(){if(window.modalPanel)this.connectToModalSystem();else{const e=setInterval(()=>{window.modalPanel&&(this.connectToModalSystem(),clearInterval(e))},100);setTimeout(()=>{clearInterval(e),console.warn("MobileNavWheelPicker: Модальная система не найдена, работаем без интеграции")},5e3)}}connectToModalSystem(){console.log("🔗 MobileNavWheelPicker: Подключение к модальной системе"),window.modalPanel.mobileNavIntegration!==this&&(window.modalPanel.mobileNavIntegration=this,console.log("✅ MobileNavWheelPicker: Интеграция с модальной системой установлена")),this.registerModalHandlers()}registerModalHandlers(){window.onModalBeforeOpen&&(window.onModalBeforeOpen("qrScannerModal",e=>{console.log("MobileNavWheelPicker: Подготовка к открытию QR-сканера"),this.popup&&this.popup.isPopupOpen&&this.popup.closePopup()}),document.addEventListener("modal.beforeOpen",e=>{this.scroll&&typeof this.scroll.blockHorizontalScroll=="function"&&this.scroll.blockHorizontalScroll()})),window.onModalAfterClose&&document.addEventListener("modal.afterClose",e=>{this.scroll&&typeof this.scroll.unblockHorizontalScroll=="function"&&this.scroll.unblockHorizontalScroll()})}setupPublicAPI(){this.api={show:()=>this.core.showNavigation(),hide:()=>this.core.hideNavigation(),convertToBackButton:e=>this.core.convertIconToBackButton(e),restoreIcon:e=>this.core.restoreIcon(e),showPopup:e=>this.popup.showPopup(e),closePopup:()=>this.popup.closePopup(),isPopupOpen:()=>this.popup.isPopupOpen,getActiveIconId:()=>this.events.activeIconId,modalSystemConnected:()=>window.modalPanel&&window.modalPanel.mobileNavIntegration===this},window.mobileNavAPI=this.api}reinitialize(){console.log("🔄 MobileNavWheelPicker: Переинициализация"),this.core&&this.core.init(),this.events&&this.events.init(),this.initModalIntegration()}destroy(){console.log("🗑️ MobileNavWheelPicker: Очистка ресурсов"),this.popup&&this.popup.isPopupOpen&&this.popup.closePopup(),this.events&&this.events.activeIconId&&this.core.restoreIcon(this.events.activeIconId),delete window.MobileNavWheelPicker,delete window.mobileNavAPI,window.modalPanel&&window.modalPanel.mobileNavIntegration===this&&(window.modalPanel.mobileNavIntegration=null)}initScrollTracking(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>this.setupScrollListeners(),300)}):setTimeout(()=>this.setupScrollListeners(),300)}setupScrollListeners(){this.scroll&&(this.scroll.setupPageScrollListener(),this.scroll.setupUserActivityListeners(),console.log("📜 MobileNavWheelPicker: Отслеживание скролла инициализировано"))}}document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>new r,100)});
